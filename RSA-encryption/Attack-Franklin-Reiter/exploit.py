from sage.all import *

# All the variable names mean the same as mentioned in the explanation
# For eg, a,b are the values in the function f = ax + b
def franklin-reiter(C1, C2, e, N, a, b):
    P.<x> = PolynomialRing(Zmod(N))
    g1 = ((a*x + b) % N)^e - C1
    g2 = x^e - C2
    return g1.gcd(g2)
